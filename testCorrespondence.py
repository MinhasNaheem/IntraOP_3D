import numpy as np
from scipy.spatial.transform import Rotation as R
from functions import *
np.set_printoptions(suppress=True)
data = np.loadtxt('AutoRegData.txt')
# define rotation parameters
theta = np.pi/3
r = R.from_quat([0, 0, np.sin(theta), np.cos(theta)])

A = np.array([[49.8782,-60,3.487824],[-49.72609,60,-5.226423],[-23.47357814,60,-44.14737964],[-12.09609478,-10,-48.51478631],[-40.45084972,-10,29.38926261],[-48.51478631,-60,12.09609478],[10.39558454,50,-48.90738004]])

B = rotate_vec(r,A)+np.random.rand(len(A),3)
# random_pts = np.random.rand(2,3)*10
# B = np.vstack((random_pts,B))
B = B[[3,0,4,1,2,5,6],:]
# B = B[[5,6,1,4,0,3,2],:]
A = np.array([[78.0156822822222,-38.0451009922798,-55.4963755286449],
            [62.3476320513736,-36.1347264014976,-63.0820991674759],
            [84.8081850605561,-24.0037571528607,-47.5871062129045],
            [62.7484457674858,-36.5960822911596,-24.2972823995491],
            [73.4013802410217,-13.343923357092,-39.5846119343586],
            [59.6727436979887,-20.788330348903,-31.8305212963981]])


B= np.array([[-6.441360329268278,-63.715656060975604, -73.283331193838251],
            [-8.7613518017356284,-43.617704949933227,-45.224686248331068],
            [7.9237316124260531,-59.671405284023649,-63.940954142011776],
            [-17.306848777777773,-58.076051717592577, -40.68569444444438],
            [6.7647104843993588,-45.873657163026508,-52.984375975038972],
            [-16.370652378787867,-50.183527560606052,-78.871084529505538]])

# A = data[:,:3]
# B = data[:,3:7]

intersec_ip, tf, reg_err= correspondence(A,B)

plotpts_A = plot_fids(A).show()
plotpts_B = plot_fids(B).show()

print("Wait")